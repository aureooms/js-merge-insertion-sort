"use strict";

Object.defineProperty(exports, "__esModule", {
	value: true
});
exports._fordjohnson = _fordjohnson;
function _fordjohnson(binarysearch) {

	var fordjohnson = function fordjohnson(compare, swap, a, i, j) {

		var m, k, t, y, p, q, r, x, l, w, s, pairswap;

		if (j - i < 2) return;

		k = m = (j - i) / 2 | 0;

		// compare pairs of elements and put largest elements at the front of the
		// array

		while (k--) {

			if (compare(a[i + k], a[i + m + k]) < 0) {

				swap(a, i + k, i + m + k);
			}
		}

		// sort the largest elements at the front recursively

		pairswap = function pairswap(a, i, j) {
			swap(a, i, j);
			swap(a, i + m, j + m);
		};

		fordjohnson(compare, pairswap, a, i, i + m);

		// merge the rest of the array into the front, one item at a time

		p = y = t = 1;

		q = 0;

		while (i + m + t <= j) {

			r = t;

			while (r-- > q) {

				w = a[i + m + t - 1];

				x = binarysearch(compare, a, i, i + m + q, w);
				l = x[0] + x[1];

				s = i + m + t;

				while (--s > l) {

					swap(a, s, s - 1);
				}
			}

			q = t;

			p *= 2;
			y = p - 2 * t;
			t += y;
		}

		r = j - i - m;

		while (r-- > q) {

			w = a[j - 1];

			x = binarysearch(compare, a, i, i + m + q, w);
			l = x[0] + x[1];

			s = j;

			while (--s > l) {

				swap(a, s, s - 1);
			}
		}
	};

	return fordjohnson;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zb3J0L2ZvcmRqb2huc29uLmpzIl0sIm5hbWVzIjpbIl9mb3Jkam9obnNvbiIsImJpbmFyeXNlYXJjaCIsImZvcmRqb2huc29uIiwiY29tcGFyZSIsInN3YXAiLCJhIiwiaSIsImoiLCJtIiwiayIsInQiLCJ5IiwicCIsInEiLCJyIiwieCIsImwiLCJ3IiwicyIsInBhaXJzd2FwIl0sIm1hcHBpbmdzIjoiOzs7OztRQUNnQkEsWSxHQUFBQSxZO0FBQVQsU0FBU0EsWUFBVCxDQUF3QkMsWUFBeEIsRUFBdUM7O0FBRTdDLEtBQU1DLGNBQWMsU0FBZEEsV0FBYyxDQUFXQyxPQUFYLEVBQXFCQyxJQUFyQixFQUE0QkMsQ0FBNUIsRUFBZ0NDLENBQWhDLEVBQW9DQyxDQUFwQyxFQUF3Qzs7QUFFM0QsTUFBSUMsQ0FBSixFQUFRQyxDQUFSLEVBQVlDLENBQVosRUFBZ0JDLENBQWhCLEVBQW9CQyxDQUFwQixFQUF3QkMsQ0FBeEIsRUFBNEJDLENBQTVCLEVBQWdDQyxDQUFoQyxFQUFvQ0MsQ0FBcEMsRUFBd0NDLENBQXhDLEVBQTRDQyxDQUE1QyxFQUFnREMsUUFBaEQ7O0FBRUEsTUFBS1osSUFBSUQsQ0FBSixHQUFRLENBQWIsRUFBaUI7O0FBRWpCRyxNQUFJRCxJQUFJLENBQUVELElBQUlELENBQU4sSUFBWSxDQUFaLEdBQWdCLENBQXhCOztBQUVBO0FBQ0E7O0FBRUEsU0FBUUcsR0FBUixFQUFjOztBQUViLE9BQUtOLFFBQVNFLEVBQUVDLElBQUVHLENBQUosQ0FBVCxFQUFrQkosRUFBRUMsSUFBRUUsQ0FBRixHQUFJQyxDQUFOLENBQWxCLElBQStCLENBQXBDLEVBQXdDOztBQUV2Q0wsU0FBTUMsQ0FBTixFQUFVQyxJQUFJRyxDQUFkLEVBQWtCSCxJQUFJRSxDQUFKLEdBQVFDLENBQTFCO0FBRUE7QUFFRDs7QUFFRDs7QUFFQVUsYUFBVyxrQkFBV2QsQ0FBWCxFQUFlQyxDQUFmLEVBQW1CQyxDQUFuQixFQUF1QjtBQUNqQ0gsUUFBTUMsQ0FBTixFQUFVQyxDQUFWLEVBQWNDLENBQWQ7QUFDQUgsUUFBTUMsQ0FBTixFQUFVQyxJQUFJRSxDQUFkLEVBQWtCRCxJQUFJQyxDQUF0QjtBQUNBLEdBSEQ7O0FBS0FOLGNBQWFDLE9BQWIsRUFBdUJnQixRQUF2QixFQUFrQ2QsQ0FBbEMsRUFBc0NDLENBQXRDLEVBQTBDQSxJQUFJRSxDQUE5Qzs7QUFFQTs7QUFFQUksTUFBSUQsSUFBSUQsSUFBSSxDQUFaOztBQUVBRyxNQUFJLENBQUo7O0FBRUEsU0FBUVAsSUFBSUUsQ0FBSixHQUFRRSxDQUFSLElBQWFILENBQXJCLEVBQXlCOztBQUV4Qk8sT0FBSUosQ0FBSjs7QUFFQSxVQUFRSSxNQUFNRCxDQUFkLEVBQWtCOztBQUVqQkksUUFBSVosRUFBRUMsSUFBRUUsQ0FBRixHQUFJRSxDQUFKLEdBQU0sQ0FBUixDQUFKOztBQUVBSyxRQUFJZCxhQUFjRSxPQUFkLEVBQXdCRSxDQUF4QixFQUE0QkMsQ0FBNUIsRUFBZ0NBLElBQUlFLENBQUosR0FBUUssQ0FBeEMsRUFBNENJLENBQTVDLENBQUo7QUFDQUQsUUFBSUQsRUFBRSxDQUFGLElBQU9BLEVBQUUsQ0FBRixDQUFYOztBQUVBRyxRQUFJWixJQUFJRSxDQUFKLEdBQVFFLENBQVo7O0FBRUEsV0FBUSxFQUFFUSxDQUFGLEdBQU1GLENBQWQsRUFBa0I7O0FBRWpCWixVQUFNQyxDQUFOLEVBQVVhLENBQVYsRUFBY0EsSUFBSSxDQUFsQjtBQUVBO0FBRUQ7O0FBRURMLE9BQUlILENBQUo7O0FBRUFFLFFBQUssQ0FBTDtBQUNBRCxPQUFJQyxJQUFJLElBQUlGLENBQVo7QUFDQUEsUUFBS0MsQ0FBTDtBQUVBOztBQUVERyxNQUFJUCxJQUFJRCxDQUFKLEdBQVFFLENBQVo7O0FBRUEsU0FBUU0sTUFBTUQsQ0FBZCxFQUFrQjs7QUFFakJJLE9BQUlaLEVBQUVFLElBQUUsQ0FBSixDQUFKOztBQUVBUSxPQUFJZCxhQUFjRSxPQUFkLEVBQXdCRSxDQUF4QixFQUE0QkMsQ0FBNUIsRUFBZ0NBLElBQUlFLENBQUosR0FBUUssQ0FBeEMsRUFBNENJLENBQTVDLENBQUo7QUFDQUQsT0FBSUQsRUFBRSxDQUFGLElBQU9BLEVBQUUsQ0FBRixDQUFYOztBQUVBRyxPQUFJWCxDQUFKOztBQUVBLFVBQVEsRUFBRVcsQ0FBRixHQUFNRixDQUFkLEVBQWtCOztBQUVqQlosU0FBTUMsQ0FBTixFQUFVYSxDQUFWLEVBQWNBLElBQUksQ0FBbEI7QUFFQTtBQUdEO0FBRUQsRUFyRkQ7O0FBdUZBLFFBQU9oQixXQUFQO0FBRUEiLCJmaWxlIjoiZm9yZGpvaG5zb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmV4cG9ydCBmdW5jdGlvbiBfZm9yZGpvaG5zb24gKCBiaW5hcnlzZWFyY2ggKSB7XG5cblx0Y29uc3QgZm9yZGpvaG5zb24gPSBmdW5jdGlvbiAoIGNvbXBhcmUgLCBzd2FwICwgYSAsIGkgLCBqICkge1xuXG5cdFx0dmFyIG0gLCBrICwgdCAsIHkgLCBwICwgcSAsIHIgLCB4ICwgbCAsIHcgLCBzICwgcGFpcnN3YXAgO1xuXG5cdFx0aWYgKCBqIC0gaSA8IDIgKSByZXR1cm4gO1xuXG5cdFx0ayA9IG0gPSAoIGogLSBpICkgLyAyIHwgMCA7XG5cblx0XHQvLyBjb21wYXJlIHBhaXJzIG9mIGVsZW1lbnRzIGFuZCBwdXQgbGFyZ2VzdCBlbGVtZW50cyBhdCB0aGUgZnJvbnQgb2YgdGhlXG5cdFx0Ly8gYXJyYXlcblxuXHRcdHdoaWxlICggay0tICkge1xuXG5cdFx0XHRpZiAoIGNvbXBhcmUoIGFbaStrXSAsIGFbaSttK2tdICkgPCAwICkge1xuXG5cdFx0XHRcdHN3YXAoIGEgLCBpICsgayAsIGkgKyBtICsgayApIDtcblxuXHRcdFx0fVxuXG5cdFx0fVxuXG5cdFx0Ly8gc29ydCB0aGUgbGFyZ2VzdCBlbGVtZW50cyBhdCB0aGUgZnJvbnQgcmVjdXJzaXZlbHlcblxuXHRcdHBhaXJzd2FwID0gZnVuY3Rpb24gKCBhICwgaSAsIGogKSB7XG5cdFx0XHRzd2FwKCBhICwgaSAsIGogKSA7XG5cdFx0XHRzd2FwKCBhICwgaSArIG0gLCBqICsgbSApIDtcblx0XHR9IDtcblxuXHRcdGZvcmRqb2huc29uKCBjb21wYXJlICwgcGFpcnN3YXAgLCBhICwgaSAsIGkgKyBtICkgO1xuXG5cdFx0Ly8gbWVyZ2UgdGhlIHJlc3Qgb2YgdGhlIGFycmF5IGludG8gdGhlIGZyb250LCBvbmUgaXRlbSBhdCBhIHRpbWVcblxuXHRcdHAgPSB5ID0gdCA9IDEgO1xuXG5cdFx0cSA9IDAgO1xuXG5cdFx0d2hpbGUgKCBpICsgbSArIHQgPD0gaiApIHtcblxuXHRcdFx0ciA9IHQgO1xuXG5cdFx0XHR3aGlsZSAoIHIgLS0+IHEgKSB7XG5cblx0XHRcdFx0dyA9IGFbaSttK3QtMV0gO1xuXG5cdFx0XHRcdHggPSBiaW5hcnlzZWFyY2goIGNvbXBhcmUgLCBhICwgaSAsIGkgKyBtICsgcSAsIHcgKSA7XG5cdFx0XHRcdGwgPSB4WzBdICsgeFsxXSA7XG5cblx0XHRcdFx0cyA9IGkgKyBtICsgdCA7XG5cblx0XHRcdFx0d2hpbGUgKCAtLXMgPiBsICkge1xuXG5cdFx0XHRcdFx0c3dhcCggYSAsIHMgLCBzIC0gMSApIDtcblxuXHRcdFx0XHR9XG5cblx0XHRcdH1cblxuXHRcdFx0cSA9IHQgO1xuXG5cdFx0XHRwICo9IDIgO1xuXHRcdFx0eSA9IHAgLSAyICogdCA7XG5cdFx0XHR0ICs9IHkgO1xuXG5cdFx0fVxuXG5cdFx0ciA9IGogLSBpIC0gbSA7XG5cblx0XHR3aGlsZSAoIHIgLS0+IHEgKSB7XG5cblx0XHRcdHcgPSBhW2otMV0gO1xuXG5cdFx0XHR4ID0gYmluYXJ5c2VhcmNoKCBjb21wYXJlICwgYSAsIGkgLCBpICsgbSArIHEgLCB3ICkgO1xuXHRcdFx0bCA9IHhbMF0gKyB4WzFdIDtcblxuXHRcdFx0cyA9IGogO1xuXG5cdFx0XHR3aGlsZSAoIC0tcyA+IGwgKSB7XG5cblx0XHRcdFx0c3dhcCggYSAsIHMgLCBzIC0gMSApIDtcblxuXHRcdFx0fVxuXG5cblx0XHR9XG5cblx0fSA7XG5cblx0cmV0dXJuIGZvcmRqb2huc29uIDtcblxufVxuIl19